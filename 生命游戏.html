<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <style>
        #main{
            width: 900px;
            height: 900px;
            margin: 10px auto;
            border: 1px solid #000;
        }
        #main:after{
            content: "";
            display: block;
            clear: both;
        }
        .cell{
            float: left;
            width: 5px;
            height: 5px;
            box-sizing: border-box;
        }
        .curr{
            background-color: #000;
        }
    </style>
</head>
<body>
    <div id="main"></div>
    <span id="info"></span>
    <script>
        var arr = [];
        var main = document.getElementById("main");
        var info = document.getElementById("info");
        var SIZE = 180;
        var TIME = 100;
        for(var i = 0;i < SIZE;i++){
            var a = [];
            for(var j = 0;j < SIZE;j++){
                var div = document.createElement("div");
                // var state = Math.random() < 0.9 ? 0 : 1;
                var state = 0;
                if(state === 1){
                    div.className = "cell curr";
                }else{
                    div.className = "cell";
                }
                main.appendChild(div);
                a[j] = {el:div,state:state,currState:state};
            }
            arr[i] = a;
        }
        // arr[11][11].state = 1;arr[11][11].currState = 1;
        // arr[13][11].state = 1;arr[13][11].currState = 1;
        // arr[12][12].state = 1;arr[12][12].currState = 1;
        // arr[13][12].state = 1;arr[13][12].currState = 1;
        // arr[12][13].state = 1;arr[12][13].currState = 1;

        arr[100][90].state = 1;arr[100][90].currState = 1;
        arr[100][91].state = 1;arr[100][91].currState = 1;
        arr[101][90].state = 1;arr[101][90].currState = 1;
        arr[101][91].state = 1;arr[101][91].currState = 1;
        arr[100][100].state = 1;arr[100][100].currState = 1;
        arr[101][100].state = 1;arr[101][100].currState = 1;
        arr[102][100].state = 1;arr[102][100].currState = 1;
        arr[99][101].state = 1;arr[99][101].currState = 1;
        arr[98][102].state = 1;arr[98][102].currState = 1;
        arr[98][103].state = 1;arr[98][103].currState = 1;
        arr[103][101].state = 1;arr[103][101].currState = 1;
        arr[104][102].state = 1;arr[104][102].currState = 1;
        arr[104][103].state = 1;arr[104][103].currState = 1;
        arr[101][104].state = 1;arr[101][104].currState = 1;
        arr[99][105].state = 1;arr[99][105].currState = 1;
        arr[103][105].state = 1;arr[103][105].currState = 1;
        arr[100][106].state = 1;arr[100][106].currState = 1;
        arr[101][106].state = 1;arr[101][106].currState = 1;
        arr[102][106].state = 1;arr[102][106].currState = 1;
        arr[101][107].state = 1;arr[101][107].currState = 1;
        arr[98][110].state = 1;arr[98][110].currState = 1;
        arr[99][110].state = 1;arr[99][110].currState = 1;
        arr[100][110].state = 1;arr[100][110].currState = 1;
        arr[98][111].state = 1;arr[98][111].currState = 1;
        arr[99][111].state = 1;arr[99][111].currState = 1;
        arr[100][111].state = 1;arr[100][111].currState = 1;
        arr[97][112].state = 1;arr[97][112].currState = 1;
        arr[101][112].state = 1;arr[101][112].currState = 1;
        arr[97][114].state = 1;arr[97][114].currState = 1;
        arr[101][114].state = 1;arr[101][114].currState = 1;
        arr[96][114].state = 1;arr[96][114].currState = 1;
        arr[102][114].state = 1;arr[102][114].currState = 1;
        arr[98][124].state = 1;arr[98][124].currState = 1;
        arr[98][125].state = 1;arr[98][125].currState = 1;
        arr[99][124].state = 1;arr[99][124].currState = 1;
        arr[99][125].state = 1;arr[99][125].currState = 1;
        for(var i = 0;i < SIZE;i++){
            for(var j = 0;j < SIZE;j++){
                if(arr[i][j].state === 1){
                    n++;
                    arr[i][j].el.className = "cell curr";
                }else{
                    arr[i][j].el.className = "cell";
                }
            }
        }
        var s,s1,s2;
        var y = 0;
        var n = 0;
        var update = function(){
            s = arr[0][1].state + arr[1][0].state + arr[1][1].state + arr[0][SIZE - 1].state + arr[1][SIZE - 1].state 
                + arr[SIZE - 1][0].state + arr[SIZE - 1][1].state + arr[SIZE - 1][SIZE - 1].state;
            if(s === 3){
                arr[0][0].currState = 1;
            }else if(s !== 2){
                arr[0][0].currState = 0;
            }
            s = arr[SIZE - 1][1].state + arr[SIZE - 2][0].state + arr[SIZE - 2][1].state + arr[0][0].state + arr[0][1].state 
                + arr[SIZE - 1][SIZE - 1].state + arr[SIZE - 2][SIZE - 1].state + arr[0][SIZE - 1].state;
            if(s === 3){
                arr[SIZE - 1][0].currState = 1;
            }else if(s !== 2){
                arr[SIZE - 1][0].currState = 0;
            }
            s = arr[0][SIZE - 2].state + arr[1][SIZE - 2].state + arr[1][SIZE - 1].state + arr[0][0].state + arr[1][0].state 
                + arr[SIZE - 1][SIZE - 2].state + arr[SIZE - 1][SIZE - 1].state + arr[SIZE - 1][0].state;
            if(s === 3){
                arr[0][SIZE - 1].currState = 1;
            }else if(s !== 2){
                arr[0][SIZE - 1].currState = 0;
            }
            s = arr[SIZE - 2][SIZE - 1].state + arr[SIZE - 2][SIZE - 2].state + arr[SIZE - 1][SIZE - 2].state + arr[0][SIZE - 2].state 
                + arr[0][SIZE - 1].state + arr[SIZE - 1][SIZE - 1].state + arr[SIZE - 2][SIZE - 1].state + arr[0][0].state;
            if(s === 3){
                arr[SIZE - 1][SIZE - 1].currState = 1;
            }else if(s !== 2){
                arr[SIZE - 1][SIZE - 1].currState = 0;
            }
            for(var j = 1;j < SIZE - 1;j++){
                s1 = arr[0][j + 1].state + arr[1][j].state + arr[1][j + 1].state + arr[1][j - 1].state + arr[0][j - 1].state + arr[SIZE - 1][j].state + arr[SIZE - 1][j + 1].state + arr[SIZE - 1][j - 1].state;
                s2 = arr[SIZE - 1][j + 1].state + arr[SIZE - 2][j].state + arr[SIZE - 2][j + 1].state + arr[SIZE - 2][j - 1].state + arr[SIZE - 1][j - 1].state + arr[0][j].state + arr[0][j + 1].state + arr[0][j - 1].state;
                if(s1 === 3){
                    arr[0][j].currState = 1;
                }else if(s1 !== 2){
                    arr[0][j].currState = 0;
                }
                if(s2 === 3){
                    arr[SIZE - 1][j].currState = 1;
                }else if(s2 !== 2){
                    arr[SIZE - 1][j].currState = 0;
                }
            }
            for(var i = 1;i < SIZE - 1;i++){
                s1 = arr[i + 1][0].state + arr[i][1].state + arr[i + 1][1].state + arr[i - 1][1].state + arr[i - 1][0].state + arr[i][SIZE - 1].state + arr[i + 1][SIZE - 1].state + arr[i - 1][SIZE - 1].state;
                s2 = arr[i + 1][SIZE - 1].state + arr[i][SIZE - 2].state + arr[i + 1][SIZE - 2].state + arr[i - 1][SIZE - 2].state + arr[i - 1][SIZE - 1].state + arr[i][0].state + arr[i + 1][0].state + arr[i - 1][0].state;
                if(s1 === 3){
                    arr[i][0].currState = 1;
                }else if(s1 !== 2){
                    arr[i][0].currState = 0;
                }
                if(s2 === 3){
                    arr[i][SIZE - 1].currState = 1;
                }else if(s2 !== 2){
                    arr[i][SIZE - 1].currState = 0;
                }
            }
            for(var i = 1;i < SIZE - 1;i++){
                for(var j = 1;j < SIZE - 1;j++){
                    s = arr[i][j + 1].state + arr[i + 1][j].state + arr[i + 1][j + 1].state + arr[i + 1][j - 1].state + arr[i][j - 1].state 
                        + arr[i - 1][j - 1].state + arr[i - 1][j].state + arr[i - 1][j + 1].state;
                    if(s === 3){
                        arr[i][j].currState = 1;
                    }else if(s !== 2){
                        arr[i][j].currState = 0;
                    }
                }
            }
            n = 0;
            for(var i = 0;i < SIZE;i++){
                for(var j = 0;j < SIZE;j++){
                    arr[i][j].state = arr[i][j].currState;
                    if(arr[i][j].state === 1){
                        n++;
                        arr[i][j].el.className = "cell curr";
                    }else{
                        arr[i][j].el.className = "cell";
                    }
                }
            }
            y++;
            info.innerText = y + "," + n;
            setTimeout(update,TIME);
        }
            setTimeout(update,TIME);
    </script>
</body>
</html>